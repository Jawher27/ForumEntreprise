<section class="section section-lg creative-section" style="background-color: hsla(0, 63%, 55%, 0.999);">
  <div class="container">
    <div class="row row-grid align-items-center">
<!--      <div class="col-md-6 order-md-2">-->
<!--        <img src="./assets/img/theme/EspaceEntrepriseimage.jpg" class="img-fluid floating creative-image">-->
<!--      </div>-->
      <div class="col-md-6 order-md-1">
        <div class="card bg-secondary text-white shadow creative-card">
          <div class="card-body">
            <div class="d-flex align-items-center mb-4">
              <div class="icon icon-lg icon-shape icon-shape-success shadow rounded-circle mr-4">
                <i class="ni ni-satisfied"></i>
              </div>
              <div>
                <h4 class="creative-title"> Internship Offer </h4>
              </div>
            </div>
            <div class="text-center">
              <button type="button" (click)="openOfferModal()" class="btn btn-danger creative-button">Add Offer</button>
            </div>
            <!-- Other content goes here -->
          </div>
        </div>
      </div>
    </div>
  </div>
</section>


 <!--  ************************ MY OFFERS   SECTION **************************   -->
<br><br><br>
<br><br><br>
<br><br><br>
<br><br><br>

<!--<section class="section section-lg pt-lg-0 mt&#45;&#45;200">-->
<!--  <div class="container">-->
<!--    <div class="row justify-content-center">-->
<!--      <div class="col-lg-12">-->
<!--        <div class="row row-grid">-->
<!--          -->
<!--        -->
<!--         &lt;!&ndash; Use *ngFor to iterate over each offer &ndash;&gt;-->
<!--         <div *ngFor="let offre of offers.slice(0, displayedOffers)" class="col-lg-4">-->
<!--            <div class="card card-lift&#45;&#45;hover shadow border-0">-->
<!--              <div class="card-body py-5">-->
<!--                <div class="icon icon-shape icon-shape-warning rounded-circle mb-4">-->
<!--                  <i class="ni ni-planet"></i>-->
<!--                  -->
<!--                </div>-->

<!--                <h6 class="text-warning text-uppercase">{{ offre.typeOffre }}</h6>-->
<!--&lt;!&ndash;                <p class="description mt-3"><strong>Required Experience :</strong> {{ offre.experience }}</p> &ndash;&gt;-->
<!--                <p class="description mt-3"><strong>Location :</strong> {{ offre.lieu }}</p> -->
<!--                <p class="description mt-3"> <strong>Posted on:</strong> {{offre.dateCreation | date }}</p> -->

<!--                <p class="description mt-3">{{ offre.description }}</p>-->
<!--                &lt;!&ndash; Action buttons go here &ndash;&gt;-->
<!--                <div class="text-center">-->
<!--                    <button type="button" (click)="openUpdate(offre)" class="btn btn-danger creative-button">Edit Offer</button>-->
<!--                  </div>-->
<!--                  <div class="text-center">-->
<!--                    <button type="button" (click)="delete(offre.idOffre)" class="btn btn-danger creative-button">Delete Offer</button>-->
<!--                  </div>-->
<!--                  <div class="text-center mt-2">-->
<!--                      <button type="button" (click)="openDetailsModal(offre)" class="btn btn-info creative-button">Voir Détails</button>-->
<!--                  </div>-->
<!--                -->
<!--              </div>-->
<!--            </div>-->
<!--          </div>-->
<!--        </div>-->
<!--      </div>-->
<!--    </div>-->
<!--  </div>-->
<!--  <div class="text-center mt-4">-->
<!--    <button *ngIf="displayedOffers < offers.length" class="btn btn-primary" (click)="loadMoreOffers()">Show More</button>-->
<!--    &lt;!&ndash; Show Less button &ndash;&gt;-->
<!--    <button *ngIf="displayedOffers > 3" class="btn btn-secondary" (click)="showLessOffers()">Show Less</button>-->
<!--  </div>-->
<!--</section>-->

<!--<section class="section section-lg pt-lg-0 mt&#45;&#45;200">-->
<!--    <div class="container">-->
<!--        <div class="row justify-content-center">-->
<!--            <div class="col-lg-12">-->
<!--                <div class="row row-grid">-->
<!--                    &lt;!&ndash; ✅ Affichage des offres &ndash;&gt;-->
<!--                    <div *ngFor="let offre of offers.slice(0, displayedOffers)" class="col-lg-4 mb-4">-->
<!--                        <div class="card card-lift&#45;&#45;hover shadow border-0">-->
<!--                            <div class="card-body py-5">-->
<!--                                <div class="icon icon-shape icon-shape-warning rounded-circle mb-4">-->
<!--                                    <i class="ni ni-planet"></i>-->
<!--                                </div>-->

<!--                                <h6 class="text-warning text-uppercase">{{ offre.typeOffre }}</h6>-->
<!--                                <p class="description mt-3"><strong>Lieu :</strong> {{ offre.lieu }}</p>-->
<!--                                <p class="description mt-3"><strong>Durée :</strong> {{ offre.periode }}</p>-->
<!--                                <p class="description mt-3"><strong>Date de début :</strong> {{ offre.dateDebut | date:'yyyy-MM-dd' }}</p>-->
<!--                                <p class="description mt-3"><strong>Date de fin :</strong> {{ offre.dateFin | date:'yyyy-MM-dd' }}</p>-->
<!--                                <p class="description mt-3"><strong>Créé le :</strong> {{ offre.dateCreation | date:'yyyy-MM-dd HH:mm' }}</p>-->
<!--                                <p class="description mt-3">{{ offre.description }}</p>-->

<!--                                &lt;!&ndash; Action buttons &ndash;&gt;-->
<!--                                <div class="text-center">-->
<!--                                    <button type="button" (click)="openUpdate(offre)" class="btn btn-danger creative-button">Edit Offer</button>-->
<!--                                </div>-->
<!--                                <div class="text-center">-->
<!--                                    <button type="button" (click)="delete(offre.idOffre)" class="btn btn-danger creative-button">Delete Offer</button>-->
<!--                                </div>-->
<!--                                <div class="text-center mt-2">-->
<!--                                    <button type="button" (click)="openDetailsModal(offre)" class="btn btn-info creative-button">Voir Détails</button>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->
<!--    <div class="text-center mt-4">-->
<!--        <button *ngIf="displayedOffers < offers.length" class="btn btn-primary" (click)="loadMoreOffers()">Show More</button>-->
<!--        <button *ngIf="displayedOffers > 3" class="btn btn-secondary" (click)="showLessOffers()">Show Less</button>-->
<!--    </div>-->
<!--</section>-->

<!--<section class="section section-lg pt-lg-0 mt&#45;&#45;200">-->
<!--    <div class="container">-->
<!--        <div class="row justify-content-center">-->
<!--            <div class="col-lg-12">-->
<!--                <div class="row row-grid">-->
<!--                    &lt;!&ndash; ✅ Affichage des offres &ndash;&gt;-->
<!--                    <div *ngFor="let offre of offers.slice(0, displayedOffers)" class="col-lg-4 mb-4">-->
<!--                        <div class="card card-lift&#45;&#45;hover shadow border-0">-->
<!--                            <div class="card-body py-5">-->
<!--                                <div class="icon icon-shape icon-shape-warning rounded-circle mb-4">-->
<!--                                    <i class="ni ni-planet"></i>-->
<!--                                </div>-->

<!--                                <h6 class="text-warning text-uppercase">{{ offre.typeOffre }}</h6>-->
<!--                                <p class="description mt-3"><strong>Lieu :</strong> {{ offre.lieu }}</p>-->
<!--                                <p class="description mt-3"><strong>Durée :</strong> {{ offre.periode }}</p>-->
<!--                                <p class="description mt-3"><strong>Date de début :</strong> {{ offre.dateDebut | date:'yyyy-MM-dd' }}</p>-->
<!--                                <p class="description mt-3"><strong>Date de fin :</strong> {{ offre.dateFin | date:'yyyy-MM-dd' }}</p>-->
<!--                                <p class="description mt-3"><strong>Créé le :</strong> {{ offre.dateCreation | date:'yyyy-MM-dd HH:mm' }}</p>-->
<!--                                <p class="description mt-3">{{ offre.description }}</p>-->

<!--                                &lt;!&ndash; Action buttons &ndash;&gt;-->
<!--                                <div class="text-center">-->
<!--                                    <button type="button" (click)="openUpdate(offre)" class="btn btn-danger creative-button">Edit Offer</button>-->
<!--                                </div>-->
<!--                                <div class="text-center">-->
<!--                                    <button type="button" (click)="delete(offre.idOffre)" class="btn btn-danger creative-button">Delete Offer</button>-->
<!--                                </div>-->
<!--                                <div class="text-center mt-2">-->
<!--                                    <button type="button" (click)="openDetailsModal(offre)" class="btn btn-info creative-button">Voir Détails</button>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->
<!--    <div class="text-center mt-4">-->
<!--        <button *ngIf="displayedOffers < offers.length" class="btn btn-primary" (click)="loadMoreOffers()">Show More</button>-->
<!--        <button *ngIf="displayedOffers > 3" class="btn btn-secondary" (click)="showLessOffers()">Show Less</button>-->
<!--    </div>-->
<!--</section>-->


<section class="section section-lg pt-lg-0 mt--200">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-12">
                <div class="row row-grid">


                    <!-- Use *ngFor to iterate over each offer -->
                    <div *ngFor="let offre of offers.slice(0, displayedOffers)" class="col-lg-4">
                        <div class="card card-lift--hover shadow border-0">
                            <div class="card-body py-5">
                                <div class="icon icon-shape icon-shape-warning rounded-circle mb-4">
                                    <i class="ni ni-planet"></i>

                                </div>

                                <h6 class="text-warning text-uppercase">{{ offre.typeOffre }}</h6>
                                <p class="description mt-3"><strong>Stage:</strong> {{ offre.titre }}</p>
                                <p class="description mt-3"><strong>Location:</strong> {{ offre.lieu }}</p>
                                <p class="description mt-3"><strong>Date debut:</strong> {{ offre.dateDebut | date }}</p>
                                <p class="description mt-3"><strong>Posted:</strong> {{ offre.dateCreation |  date:'yyyy-MM-dd HH:mm' }}</p>
                                <p class="description mt-3">{{ offre.description }}</p>
                                <!-- Action buttons go here -->
                                <div class="text-center">
                                    <button type="button" (click)="openUpdate(offre)" class="btn btn-danger creative-button">Edit Offer</button>
                                </div>
                                <div class="text-center">
                                    <button type="button" (click)="delete(offre.idOffre)" class="btn btn-danger creative-button">Delete Offer</button>
                                </div>
                                <div class="text-center mt-2">
                                    <button type="button" (click)="openDetailsModal(offre)" class="btn btn-info creative-button">Voir Détails</button>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="text-center mt-4">
        <button *ngIf="displayedOffers < offers.length" class="btn btn-primary" (click)="loadMoreOffers()">Show More</button>
        <!-- Show Less button -->
        <button *ngIf="displayedOffers > 3" class="btn btn-secondary" (click)="showLessOffers()">Show Less</button>
    </div>
</section>


 <!--************************************     MODAL    ************************************-->

<!-- ✅ MODAL AJOUT OFFRE AVEC CHAMPS INTELLIGENTS -->
<ng-template #offerModal let-c="close" let-d="dismiss">
    <div class="modal-content">
        <div class="modal-body p-0">
            <div class="card bg-secondary shadow border-0">
                <div class="card-header bg-white pb-5">
                    <div class="text-muted text-center mb-3">
                        <small>Ajouter une Offre</small>
                    </div>
                </div>
                <div class="card-body px-lg-5 py-lg-5">
                    <form role="form" (ngSubmit)="onSubmitForm()">
                        <div class="form-group mb-3">
                            <label for="titre">Titre</label>
                            <input class="form-control" placeholder="Titre" id="titre" name="titre" [(ngModel)]="o.titre">
                        </div>

                        <div class="form-group mb-3">
                            <label for="typeOffre">Type d'offre</label>
                            <select class="form-control" id="typeOffre" name="typeOffre" [(ngModel)]="o.typeOffre" (change)="onTypeChange()">
                                <option *ngFor="let opt of typeOptions" [ngValue]="opt.value">{{ opt.label }}</option>
                            </select>
                        </div>

                        <div class="form-group mb-3">
                            <label for="periode">Période</label>
                            <input class="form-control" id="periode" name="periode" [value]="o.periode" readonly>
                        </div>

                        <div class="form-group mb-3">
                            <label for="dateDebut">Date de début</label>
                            <input type="date" class="form-control" id="dateDebut" name="dateDebut" [(ngModel)]="o.dateDebut" (change)="onDateDebutChange()">
                        </div>

                        <div class="form-group mb-3">
                            <label for="dateFin">Date de fin</label>
                            <input class="form-control" id="dateFin" name="dateFin" [value]="o.dateFin | date:'yyyy-MM-dd'" readonly>
                        </div>

                        <div class="form-group mb-3">
                            <label for="lieu">Lieu</label>
                            <input class="form-control" placeholder="Lieu" id="lieu" name="lieu" [(ngModel)]="o.lieu">
                        </div>

                        <div class="form-group mb-3">
                            <label for="description">Description</label>
                            <textarea class="form-control" id="description" name="description" [(ngModel)]="o.description" rows="4"></textarea>
                        </div>

<!--                        <div class="form-group form-check mb-3">-->
<!--                            <input class="form-check-input" type="checkbox" id="validite" name="validite" [(ngModel)]="o.validite">-->
<!--                            <label class="form-check-label" for="validite">Offre Active</label>-->
<!--                        </div>-->

                        <div class="text-center">
                            <button type="submit" class="btn btn-primary my-4">Soumettre</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</ng-template>


<!-- Modale de détails et candidatures -->
<ng-template #detailsModal let-c="close" let-d="dismiss">
    <div class="modal-content">
        <div class="modal-header">
            <h4 class="modal-title">Détails de l'offre</h4>
            <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body">
            <!-- PDF Viewer -->
            <div *ngIf="showCv || showCoverLetter" class="pdf-viewer-container">
                <div class="pdf-viewer-header d-flex justify-content-between align-items-center mb-2">
                    <h5 class="mb-0">{{ showCv ? 'CV' : 'Lettre de motivation' }} - {{ selectedCandidature?.user?.firstName }} {{ selectedCandidature?.user?.lastName }}</h5>
                    <button class="btn btn-sm btn-danger" (click)="closeViewer()">
                        <i class="ni ni-fat-remove"></i> Fermer
                    </button>
                </div>
                <div class="pdf-viewer-content">
<!--                    <iframe *ngIf="showCv && cvUrl" [src]="cvUrl" width="100%" height="600" frameborder="0"></iframe>-->
<!--                    <iframe *ngIf="showCoverLetter && coverLetterUrl" [src]="coverLetterUrl" width="100%" height="600" frameborder="0"></iframe>-->

                    <iframe
                            *ngIf="showCv && selectedCandidature?.idCondidature && documentUrls.get(selectedCandidature.idCondidature)?.cvUrl"
                            [src]="documentUrls.get(selectedCandidature.idCondidature).cvUrl"
                            width="100%"
                            height="600"
                            frameborder="0"></iframe>
                    <iframe
                            *ngIf="showCoverLetter && selectedCandidature?.idCondidature && documentUrls.get(selectedCandidature.idCondidature)?.coverLetterUrl"
                            [src]="documentUrls.get(selectedCandidature.idCondidature).coverLetterUrl"
                            width="100%"
                            height="600"
                            frameborder="0"></iframe>
                </div>
            </div>

            <!-- Détails de l'offre -->
            <div [class.d-none]="showCv || showCoverLetter">
                <div class="row">
                    <div class="col-md-12">
                        <div class="card shadow">
                            <div class="card-header bg-white">
                                <h5 class="text-warning text-uppercase">{{ selectedOffre.typeOffre }}</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <strong>Description:</strong>
                                    <p>{{ selectedOffre.description }}</p>
                                </div>
                                <div class="row">
<!--                                    <div class="col-md-6">-->
<!--                                        <p><strong>Experience requise:</strong> {{ selectedOffre.experience }}</p>-->
<!--                                    </div>-->
                                    <div class="col-md-6">
                                        <p><strong>Lieu:</strong> {{ selectedOffre.lieu }}</p>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <p><strong>Date de publication:</strong> {{ selectedOffre.dateCreation | date }}</p>
                                    </div>
<!--                                    <div class="col-md-6">-->
<!--                                        <p><strong>Validité:</strong> {{ selectedOffre.validite ? 'Active' : 'Inactive' }}</p>-->
<!--                                    </div>-->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Liste des candidatures -->
                <div class="row mt-4">
                    <div class="col-md-12">
                        <div class="card shadow-sm rounded-lg border-0">
                            <div class="card-header bg-white border-0 py-3">
                                <h5 class="font-weight-bold text-primary mb-0">Liste des candidatures</h5>
                            </div>
                            <div class="card-body px-4">
                                <!-- État vide -->
                                <div *ngIf="candidatures.length === 0" class="text-center py-5">
                                    <div class="empty-state">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="text-muted mb-3">
                                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                            <polyline points="14 2 14 8 20 8"></polyline>
                                            <line x1="16" y1="13" x2="8" y2="13"></line>
                                            <line x1="16" y1="17" x2="8" y2="17"></line>
                                            <polyline points="10 9 9 9 8 9"></polyline>
                                        </svg>
                                        <p class="text-muted font-weight-medium">Aucune candidature pour cette offre.</p>
                                    </div>
                                </div>

                                <!-- Table des candidatures -->
                                <div *ngIf="candidatures.length > 0" class="table-responsive">
                                    <table class="table align-items-center table-flush table-hover">
                                        <thead>
                                        <tr>
                                            <th scope="col" class="text-uppercase text-muted font-weight-medium text-xs">Candidat</th>
                                            <th scope="col" class="text-uppercase text-muted font-weight-medium text-xs">État</th>
                                            <th scope="col" class="text-uppercase text-muted font-weight-medium text-xs">Documents</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr *ngFor="let candidature of candidatures" class="border-top">
                                            <td class="py-3">
                                                <div class="d-flex align-items-center">
                                                    <div class="avatar avatar-sm rounded-circle bg-primary text-white mr-3 d-flex align-items-center justify-content-center">
                                                        {{ candidature.user?.firstName.charAt(0) }}{{ candidature.user?.lastName.charAt(0) }}
                                                    </div>
                                                    <div>
                                                        <h6 class="mb-0">{{ candidature.user?.firstName }} {{ candidature.user?.lastName }}</h6>
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="py-3">
                                                <select class="form-select custom-state-select"
                                                        [(ngModel)]="candidature.etatCondidature"
                                                        (change)="updateCandidatureStatus(candidature,candidature.etatCondidature)"
                                                        [ngClass]="getStateCssClass(candidature.etatCondidature)">
                                                    <option *ngFor="let stateOption of getStateOptionsForCandidature(candidature)"
                                                            [value]="stateOption.value"
                                                            [disabled]="!stateOption.selectable"
                                                            [ngClass]="{'state-option': true, 'state-option-disabled': !stateOption.selectable}">
                                                        {{ stateOption.displayName }}
                                                    </option>
                                                </select>
                                            </td>
                                            <td class="py-3">
                                                <div class="d-flex">
                                                    <button (click)="viewCV(candidature)" class="btn btn-sm btn-icon btn-soft-info rounded-circle mr-2" title="Voir le CV">
                                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                                            <polyline points="14 2 14 8 20 8"></polyline>
                                                            <line x1="16" y1="13" x2="8" y2="13"></line>
                                                            <line x1="16" y1="17" x2="8" y2="17"></line>
                                                            <polyline points="10 9 9 9 8 9"></polyline>
                                                        </svg>
                                                    </button>
                                                    <button (click)="viewCoverLetter(candidature)" class="btn btn-sm btn-icon btn-soft-primary rounded-circle" title="Voir la lettre de motivation">
                                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                                                        </svg>
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div [class.d-none]="showCv || showCoverLetter" class="modal-footer border-top-0">
                    <button type="button" class="btn btn-secondary rounded-pill px-4" (click)="d('Close click')">Fermer</button>
                </div>
            </div>
        </div>
    </div>
</ng-template>
